---
title: "Lab4_R4L"
author: "R4L"
date: "2/5/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(tidyverse)
babies <- read_csv("https://raw.githubusercontent.com/ervance1/Sp2018-Data-Science-repo/master/babies2a.dat")
babies <- rename(babies, bwtoz = `bwt/oz`)
```


```{r}
babies <- babies %>%
  mutate(mrace2 = ifelse(mrace <= 5, 1, mrace))

ggplot(data=babies) +
  geom_bar(aes(x= med, fill=as.factor(mrace2)), position = "Dodge")+
  scale_fill_discrete(name = "Women's Race",
                      labels = c('White', 'Black', 'Asian', 'Mix', 'Unknown'))+
  xlab('Mothers Education')
  babies <-na.omit(babies)

```

```{r}
ggplot(data=babies)+
  geom_bar(mapping = aes(x=mage, fill=as.factor(mrace2)))+
  geom_smooth(mapping = aes(x=mage, y= dage, fill= dage), se=FALSE)+
  scale_fill_discrete(name = "Women's Race",
                      labels = c('White', 'Black', 'Asian', 'Mix', 'Unknown'))
  theme_bw()+
  ggtitle("Relationship Between Women Termination Age and Education Background")+
  xlab("Termination (Mother's Age)")
```

```{r}
babies <- babies %>%
  mutate(mrace2 = ifelse(mrace <= 5, 1, mrace))
```



```{r}
ggplot(data=babies)+
  geom_bar(mapping = aes(x=bwtoz, fill = as.factor(smoke)), position = "dodge")+
  ggtitle('How smoking can affect babies body weight')+
  scale_fill_discrete(name = 'Does Mother Smoke',
                       labels = c('Yes', 'No'))
```

```{r}
babies<-na.omit(babies)
ggplot(data = babies, aes(x = as.factor(parity), fill =as.factor(inc)))+
  geom_bar(position = 'dodge')+
  scale_fill_discrete(name = 'Income',
                      labels = c('Under $2500', '$2500-$4999', '$5000-$9999', '$10000-$19999', '$20000-$29999', '$30000-$49999', '$50000-$74999', '$75000-$99999', '$100000-$149999', '$150000+'))+
  xlab('Number of Previous Pregnancies')
 
cor(babies$parity, babies$inc)



```
```{r}
ggplot(data=babies, aes(x=bwtoz, y=gestation))+
  geom_point()
```

